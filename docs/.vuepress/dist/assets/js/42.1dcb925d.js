(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{440:function(t,a,s){"use strict";s.r(a);var n=s(45),r=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"nginx优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx优化"}},[t._v("#")]),t._v(" Nginx优化")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"优化目的"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化目的"}},[t._v("#")]),t._v(" 优化目的")]),t._v(" "),s("p",[t._v("标准情况下，软件默认的参数都是对安装软件的硬件标准来设置的，⽬前我们服务器的硬件资源远远⼤于要求的标准，所以为了让服务器性能更加出众，充分利⽤服\n务器的硬件资源，我们⼀般需要优化APP的并发数来提升服务器的性能。\n")]),s("div",{staticStyle:{"margin-top":"50px"}}),s("p"),t._v(" "),s("h3",{attrs:{id:"并发优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#并发优化"}},[t._v("#")]),t._v(" 并发优化")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("#启动工作进程数量\nworker_processes  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n#cpu亲和力，指定进程运行的核的编号，采用掩码的方式设置编号。保证每个核上都有一个进程\nworker_cpu_affinity   "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0001")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0010")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0100")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n#单个工作进程维护的请求队列长度\nevents "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  worker_connections  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"长链接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长链接"}},[t._v("#")]),t._v(" 长链接")]),t._v(" "),s("p",[t._v("减少服务器维护因为与客户端建立http连接产生的大量tcp三次握手四次断开的开销")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("keepalive_timeout  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("代表关闭\n#keepalive_timeout  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n#keepalive_requests "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8192")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"压缩"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#压缩"}},[t._v("#")]),t._v(" 压缩")]),t._v(" "),s("p",[t._v("降低传输时间，增加用户体验度；降低公司带宽费用。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("gzip  on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngzip_proxied any"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngzip_min_length "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngzip_buffers "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngzip_comp_level "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\ngzip_types text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plain text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("javascript application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 开启gzip\n  gzip off"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n#gzip_proxied，Nginx做为反向代理的时候启用：\n\toff – 关闭所有的代理结果数据压缩\n\texpired – 如果header中包含”Expires”头信息，启用压缩\n\tno"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cache – 如果header中包含”Cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("no"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("cache”头信息，启用压缩\n\tno"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("store – 如果header中包含”Cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("no"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("store”头信息，启用压缩\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" – 如果header中包含”Cache"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Control"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v("”头信息，启用压缩\n\tno_last_modified – 启用压缩，如果header中包含”Last_Modified”头信息，启用压缩\n\tno_etag – 启用压缩，如果header中包含“ETag”头信息，启用压缩\n\tauth – 启用压缩，如果header中包含“Authorization”头信息，启用压缩\n\tany – 无条件压缩所有结果数据\n\n# 启用gzip压缩的最小文件，小于设置值的文件将不会压缩\n  gzip_min_length "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# gzip 压缩级别，"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("，数字越大压缩的越好，也越占用"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CPU")]),t._v("时间，后面会有详细说明\n  gzip_comp_level "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 进行压缩的文件类型。javascript有多种形式。其中的值可以在 mime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("types 文件中找到。\n  gzip_types text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("plain application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("javascript text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("css application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("xml text"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("javascript application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("httpd"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("php image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("jpeg image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("gif image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("png application"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("vnd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ms"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("fontobject font"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("ttf font"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("opentype font"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("woff image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("svg"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("xml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 增加响应头”Vary"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Accept"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Encoding”，是否在http header中添加Vary"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Accept"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("Encoding，建议开启\n  gzip_vary on"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 禁用"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("IE")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" gzip\n  gzip_disable "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MSIE [1-6]\\."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 设置压缩所需要的缓冲区大小     \n  gzip_buffers "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("32")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("k"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n# 设置gzip压缩针对的"),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP")]),t._v("协议版本\n  gzip_http_version "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"静态缓存"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#静态缓存"}},[t._v("#")]),t._v(" 静态缓存")]),t._v(" "),s("p",[t._v("将部分数据缓存在用户本地磁盘，用户加载时，如果本地和服务器的数据一致，则从本地加载。提升用户访问速度，提升体验度。节省公司带宽成本。")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("#expires指令：开启缓存并指定静态缓存时间\nlocation "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("~")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("  \\"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("png"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("gif"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("$ "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  expires "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("h"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"🔗相关链接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#🔗相关链接"}},[t._v("#")]),t._v(" 🔗相关链接")])])}),[],!1,null,null,null);a.default=r.exports}}]);