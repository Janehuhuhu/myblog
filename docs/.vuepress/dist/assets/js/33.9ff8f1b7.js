(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{429:function(t,a,s){"use strict";s.r(a);var n=s(45),e=Object(n.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"pnpm-和-yarn2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pnpm-和-yarn2"}},[t._v("#")]),t._v(" pnpm 和 yarn2")]),t._v(" "),s("hr"),t._v(" "),s("h3",{attrs:{id:"为什么会引入pnpm和yarn2的概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#为什么会引入pnpm和yarn2的概念"}},[t._v("#")]),t._v(" 为什么会引入pnpm和yarn2的概念")]),t._v(" "),s("p",[t._v("项目中需要获取包版本，使用了 "),s("code",[t._v("node_modules")]),t._v("，具体如下:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" cwd "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pkgDir "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cwd"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node_modules/'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" key"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nversion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" cwd"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" pkgDir "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version\nmajorVersion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" _"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("该种方式的问题是，获取的包版本是最外层，很可能不是实际上使用的包版本，这和 "),s("code",[t._v("npm")]),t._v(" 包寻址方式不符。另外，该方式不具有扩展性，未来 "),s("code",[t._v("pnpm")]),t._v(" 和 "),s("code",[t._v("yarn2")]),t._v(" 中通过 "),s("code",[t._v("node_modules")]),t._v(" 会拿不到实际使用的包内容")]),t._v(" "),s("p",[t._v("所以，优化后的方案如下：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" pkg "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/package.json'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nversion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" pkg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("version\nmajorVersion "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'0'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"常见问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常见问题"}},[t._v("#")]),t._v(" 常见问题")]),t._v(" "),s("h4",{attrs:{id:"_1-为什么子包中-require-的寻址顺序一直是子包及父级地址而不是项目及父级地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么子包中-require-的寻址顺序一直是子包及父级地址而不是项目及父级地址"}},[t._v("#")]),t._v(" 1. 为什么子包中 require 的寻址顺序一直是子包及父级地址而不是项目及父级地址？")]),t._v(" "),s("p",[t._v("因为使用了 "),s("code",[t._v("yarn link")]),t._v("，所以会顺着子包及父级向上寻址\n")]),s("div",{staticStyle:{"margin-top":"30px"}}),s("p"),t._v(" "),s("h4",{attrs:{id:"_2-为啥项目中的依赖的依赖要用-dependencies"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-为啥项目中的依赖的依赖要用-dependencies"}},[t._v("#")]),t._v(" 2. 为啥项目中的依赖的依赖要用 dependencies?")]),t._v(" "),s("p",[t._v("因为项目安装该依赖后并不会安装该依赖的 "),s("code",[t._v("devDependencies")]),t._v(" 类型依赖，他是开发时依赖。所以开发 "),s("code",[t._v("npm")]),t._v(" 的时候注意一些 "),s("code",[t._v("require")]),t._v(" 的运行时用的包一定要装在 "),s("code",[t._v("dependencies")]),t._v(" 中\n")]),s("div",{staticStyle:{"margin-top":"50px"}}),s("p"),t._v(" "),s("h3",{attrs:{id:"pnpm-知识扫盲"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pnpm-知识扫盲"}},[t._v("#")]),t._v(" pnpm 知识扫盲")]),t._v(" "),s("p",[t._v("当你安装一个软件包，我们把它保存在你的机器上的一个全局存储目录中，然后我们创建一个硬链接而不是复制。 对于模块的每个版本，只会有一个副本保存在磁盘上。当使用 "),s("code",[t._v("npm")]),t._v(" 或 "),s("code",[t._v("yarn")]),t._v(" 时，如果有 "),s("em",[t._v("100")]),t._v(" 个使用 "),s("code",[t._v("lodash")]),t._v(" 的项目，你的磁盘上就会有有 "),s("em",[t._v("100")]),t._v(" 份 "),s("code",[t._v("lodash")]),t._v(" 的拷贝。"),s("code",[t._v("pnpm")]),t._v(" 能帮助您节省千兆字节的磁盘空间！")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://segmentfault.com/a/1190000013214927",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么用pnpm"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://pnpm.io/zh/motivation",target:"_blank",rel:"noopener noreferrer"}},[t._v("pnmp官网"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticStyle:{"margin-top":"50px"}}),t._v(" "),s("h3",{attrs:{id:"yarn2知识扫盲"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#yarn2知识扫盲"}},[t._v("#")]),t._v(" yarn2知识扫盲")]),t._v(" "),s("p",[s("code",[t._v("yarn2")]),t._v(" 将不再存在 "),s("code",[t._v("node_modules")]),t._v(" 文件夹，所有的依赖都会被压缩成一个文件放在特定的地方")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/107343333",target:"_blank",rel:"noopener noreferrer"}},[t._v("yarn2功能"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=e.exports}}]);