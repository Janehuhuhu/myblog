### ç»„ä»¶åº“
***

### ç®€ä»‹
ç»„ä»¶åº“æœ¬è´¨ä¸Šæ˜¯ä¸€ç§ `npm` åŒ…ï¼Œé’ˆå¯¹å¯å¤ç”¨çš„ç»„ä»¶åšçš„ä¸€ç§æ‰“åŒ…å·¥ä½œ
<div style='margin-top: 50px'></div>

### å¼€å‘
#### webpack å…¥å£æ–‡ä»¶
1. å¯¹äºå¤š `package` æ¨¡å¼ï¼ˆsrc/packagesï¼‰ï¼Œè¿™æ˜¯æ•´ä½“çš„å…¥å£æ–‡ä»¶
```js
import Index from './packages/demo/index.js'
const components = [Index]
const install = function(Vue) {
  components.forEach(item => {
    if (item.install) {
      Vue.use(item)
    } else if (item.name) {
      Vue.component(item.name, item)
    }
  })
}

// è‡ªåŠ¨å®‰è£… æ–¹ä¾¿æ‰“åŒ…æˆå‹ç¼©æ–‡ä»¶, ç”¨<script scr=''></script>çš„æ–¹å¼å¼•ç”¨
if (typeof window !== 'undefined' && window.Vue) {
  install(window.Vue)
}
// æ³¨æ„è¿™ç§å¯¼å‡ºæ–¹å¼ï¼Œåé¢ä¼šè¯´åˆ°
export default {
  install,
  Index,
}
```

2. å•ä¸ª `pacakge` æ‰“åŒ…å…¥å£æ–‡ä»¶ï¼š
```js
import MyComponent1 from './index.vue'

/* istanbul ignore next */
MyComponent1.install = function(Vue) {
  Vue.component(MyComponent1.name, MyComponent1)
}
export default MyComponent1
```
<div style='margin-top: 50px'></div>

### å¼•å…¥æ–¹å¼
#### æŒ‰éœ€å¼•å…¥å•ä¸ªåŒ…
```js
import MyCompList from '@nibfe/pattern-select/build/es/packages/parttern-list/index.jsâ€™. 
Vue.use(MyCompList)
```

#### å¼•å…¥å…¨éƒ¨åŒ…
è¿™ç§å¼•å…¥æ–¹å¼ä¸€å®šè¦ä¿è¯åœ¨ 1 ä¸­çš„å…¥å£æ–‡ä»¶ä¸­åŒ…å«è¦å¼•å…¥çš„ç»„ä»¶ï¼Œå¦‚ `Index`
```js
import MyComp from '@nibfe/pattern-select'
Vue.use(MyComp)
```

#### æŒ‰éœ€å¼•å…¥
**1ä¸­export default** çš„å¯¼å‡ºæ–¹å¼ä¸èƒ½ç”¨ {} çš„æ–¹å¼å¼•å…¥ï¼Œå¿…é¡»ç”¨ `export` çš„æ–¹å¼å¯¼å‡ºæ‰èƒ½ç”¨ {} å¯¼å…¥
```js
import { MyComp } from '@nibfe/pattern-select'
Vue.use(MyComp)
```

å¦‚æœæƒ³è¦ç”¨ {} æŒ‰éœ€å¼•å…¥çš„æ–¹å¼ï¼Œé‚£å°±å¿…é¡»è¦å¼•å…¥ `babel-plugin-import`
```js
module.exports = {
  presets: ['@vue/app'],
  plugins: [
    [
      'import',
      {
        libraryName: '@nibfe/vault',
        customStyleName(name) {
          return `@nibfe/vault/build/styles/${name}.css`
        },
        customName(name) {
          return `@nibfe/vault/build/es/${name}/${name}.js`
        },
      },
    ],
  ],
}
```
<div style='margin-top: 50px'></div>

### ç»„ä»¶åº“æ‰“åŒ…
æ‰“åŒ…å·¥å…·ç”¨çš„æ˜¯ `rollup`ã€‚æ‰“åŒ…æ–¹æ³• `CJS, AMD, UMD å’Œ ESM`, å…¶ä¸­ `AMD` è¯´çš„å¼‚æ­¥æ˜¯ä¸‹è½½æ—¶ä¸ä¼šé˜»å¡å…¶ä»–è¿›ç¨‹ï¼Œå°±åƒæ˜¯ `script` ä¸­çš„ `async`ã€‚å…·ä½“è¯¦ç»†çœ‹ğŸ‘‡ä¸‹é¢é“¾æ¥
<div style='margin-top: 50px'></div>

### å¼•å…¥ç¬¬ä¸‰æ–¹åº“
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæƒ³è¦æŒ‰éœ€å¼•å…¥ï¼Œå¿…é¡»æ‰“åŒ…çš„ç»“æœä¸­æœ‰æŒ‰å•åŒ…æ‰“åŒ…çš„ï¼Œä¹Ÿæœ‰æ•´ä½“æ‰“åŒ…çš„ç»“æœã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ `packages` ç›®å½•å¤–æœ‰ `index.js` å…¥å£æ–‡ä»¶ï¼Œå­ç›®å½•ä¸­ä¹Ÿæœ‰å…¥å£æ–‡ä»¶çš„åŸå› ã€‚é‚£ä¹ˆè¯¥å¦‚ä½•å¼•å…¥ç¬¬ä¸‰æ–¹åº“å‘¢ï¼Œå¦‚æœæ˜¯å±€éƒ¨å¼•å…¥ï¼Œåœ¨ `packages` å­åŒ…çš„ `.vue` ä¸­å¼•å…¥å³å¯ã€‚
```js
// src/packages/xx/index.vue
import '@ss/mtd-vue/lib/theme2/index.css'

// æŒ‰éœ€å¼•å…¥
import a from '../build/es/packages/demo/index.js'
```

å¦‚æœæ˜¯å…¨å±€å¼•å…¥ï¼Œå¿…é¡»åœ¨å…¨å±€çš„æ‰“åŒ…å…¥å£æ–‡ä»¶ä¸­ï¼ˆsrc/index.jsï¼‰ä¸­å¼•å…¥ï¼Œæ‰“åŒ…å‡ºçš„ç»“æœä¹Ÿåªèƒ½å…¨å±€å¼•å…¥ï¼Œä¸èƒ½æŒ‰éœ€å¼•å…¥ï¼Œå› ä¸ºåœ¨æŒ‰éœ€æ‰“åŒ…çš„æ–‡ä»¶ä¸­ä¸ä¼šåŒ…å«å…¨å±€çš„æ–‡ä»¶ã€‚æ³¨æ„ï¼š`entry/main` ä¸­æ˜¯æµ‹è¯•æ–‡ä»¶ï¼Œæ–¹ä¾¿æœ¬åœ°æµ‹è¯•ç»„ä»¶åº“çš„ï¼Œä¸ä¼šå†™å…¥åˆ°æœ€åçš„æ‰“åŒ…ç»“æœä¸­
```js
// src/index.js
import '@ss/mtd-vue/lib/theme2/index.css'

// æ‰“åŒ…ç»“æœå¼•å…¥ï¼Œå…¨å±€å¼•å…¥
import a from '../build/es/index.es'
Vue.use(a)
```
ä¸ºäº†é˜²æ­¢ç¬¬ä¸‰æ–¹åº“äºŒæ¬¡æ‰“åŒ…ï¼ˆåŸåŒ…æ‰“åŒ…è¿‡ä¸€æ¬¡ï¼‰ï¼Œéœ€è¦åœ¨ç»„ä»¶åº“æ‰“åŒ…çš„æ—¶å€™æ’é™¤æ‰
```js
// vue.config.js
pluginOptions: {
  romeLibrary: {
    rollupOptions: {
      external: [/@ss\/mtd-vue/, /@nibfe\/dz-form/], // æ­¤å¤„ä¸¾ä¾‹,å…¶ä¸­/@gfe/,/@hfe/æ˜¯é€šè¿‡æ­£åˆ™çš„æ–¹å¼åŒ¹é…ï¼Œ'@/lib/axios'å­—ç¬¦ä¸²æ–¹å¼æ˜¯åŒ¹é…åŒåç¬¬ä¸‰æ–¹åŒ…
    },
  },
},
```
<div style='margin-top: 50px'></div>

### ğŸ”—ç›¸å…³é“¾æ¥
- [babel-plugin-import](https://www.npmjs.com/package/babel-plugin-import)
- [æ‰‹æŠŠæ‰‹æ•™ä½ å¼€å‘ç»„ä»¶](https://juejin.cn/post/6844903459536240648)
- [ç®€å•å®ç° babel-plugin-import](https://juejin.cn/post/6905708824703795214)
- [CJS, AMD, UMD å’Œ ESM](https://juejin.cn/post/6935973925004247077)
- [AMDã€CJS](http://www.360doc.com/content/19/0519/15/13328254_836725029.shtml)
- [webpackå’Œrollup](https://juejin.cn/post/6844903735236247565)
- [rollup](https://www.rollupjs.com/)
- [rollupé…ç½®æ–‡ä»¶](https://blog.cjw.design/blog/old/rollup#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%80%89%E9%A1%B9%E8%AF%A6%E8%A7%A3)

