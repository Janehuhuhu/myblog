<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue 基础 | 小生天地</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.jpeg">
    <meta name="description" content="小生学习天地">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.a280ad29.js" as="script"><link rel="preload" href="/assets/js/2.fb79666b.js" as="script"><link rel="preload" href="/assets/js/40.04ca984c.js" as="script"><link rel="prefetch" href="/assets/js/10.bb154cb0.js"><link rel="prefetch" href="/assets/js/11.daa4d740.js"><link rel="prefetch" href="/assets/js/12.7411366b.js"><link rel="prefetch" href="/assets/js/13.ad26b898.js"><link rel="prefetch" href="/assets/js/14.274e4703.js"><link rel="prefetch" href="/assets/js/15.cf27d9ea.js"><link rel="prefetch" href="/assets/js/16.2a9e14ef.js"><link rel="prefetch" href="/assets/js/17.d39df2ac.js"><link rel="prefetch" href="/assets/js/18.6517bc79.js"><link rel="prefetch" href="/assets/js/19.6285898a.js"><link rel="prefetch" href="/assets/js/20.5d706858.js"><link rel="prefetch" href="/assets/js/21.d1d4d502.js"><link rel="prefetch" href="/assets/js/22.699f6b0f.js"><link rel="prefetch" href="/assets/js/23.3dd9099b.js"><link rel="prefetch" href="/assets/js/24.274c37c4.js"><link rel="prefetch" href="/assets/js/25.ec3997de.js"><link rel="prefetch" href="/assets/js/26.57c0a967.js"><link rel="prefetch" href="/assets/js/27.5ae07707.js"><link rel="prefetch" href="/assets/js/28.654e66eb.js"><link rel="prefetch" href="/assets/js/29.0201f085.js"><link rel="prefetch" href="/assets/js/3.757746cd.js"><link rel="prefetch" href="/assets/js/30.36a739f1.js"><link rel="prefetch" href="/assets/js/31.e41a663e.js"><link rel="prefetch" href="/assets/js/32.3c7224c6.js"><link rel="prefetch" href="/assets/js/33.e7e98d9b.js"><link rel="prefetch" href="/assets/js/34.40371dde.js"><link rel="prefetch" href="/assets/js/35.cacd26c6.js"><link rel="prefetch" href="/assets/js/36.4b933532.js"><link rel="prefetch" href="/assets/js/37.bb8fba66.js"><link rel="prefetch" href="/assets/js/38.c4f932ba.js"><link rel="prefetch" href="/assets/js/39.74dd58b4.js"><link rel="prefetch" href="/assets/js/4.26d385be.js"><link rel="prefetch" href="/assets/js/41.b98bbcdf.js"><link rel="prefetch" href="/assets/js/42.34a5e582.js"><link rel="prefetch" href="/assets/js/5.7348d45e.js"><link rel="prefetch" href="/assets/js/6.96312c4f.js"><link rel="prefetch" href="/assets/js/7.27e03c61.js"><link rel="prefetch" href="/assets/js/8.7e1b958f.js"><link rel="prefetch" href="/assets/js/9.f23b4cca.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpeg" alt="小生天地" class="logo"> <span class="site-name can-hide">小生天地</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/Janehuhuhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://github.com/Janehuhuhu" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vue/vue使用/vue基础.html" class="active sidebar-link">vue 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#vue-基础" class="sidebar-link">vue 基础</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#process-argv" class="sidebar-link">process.argv</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#可复用和组合" class="sidebar-link">可复用和组合</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#组件库" class="sidebar-link">组件库</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#generatorapi" class="sidebar-link">GeneratorAPI</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#history-和-hash-模式" class="sidebar-link">history 和 hash 模式</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#browser-module-main-字段" class="sidebar-link">browser，module，main 字段</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#pluginapi" class="sidebar-link">pluginAPI</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#loadmodule" class="sidebar-link">loadmodule</a></li><li class="sidebar-sub-header"><a href="/vue/vue使用/vue基础.html#配置文件" class="sidebar-link">配置文件</a></li></ul></li><li><a href="/vue/vue源码/双向绑定.html" class="sidebar-link">vue 源码</a></li><li><a href="/vue/常见问题/大小写.html" class="sidebar-link">FAQ</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="vue-基础"><a href="#vue-基础" class="header-anchor">#</a> vue 基础</h2> <p><code>vue</code> 基础知识</p> <h2 id="process-argv"><a href="#process-argv" class="header-anchor">#</a> process.argv</h2> <p>命令行 <strong>node '/Users/jane/Desktop/test-01/sourcemap-hj0/a.js' --a b c</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 执行</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span>

<span class="token comment">// 结果</span>
<span class="token punctuation">[</span>
  <span class="token string">'/Users/jane/.nvm/versions/node/v14.17.4/bin/node'</span><span class="token punctuation">,</span>
  <span class="token string">'/Users/jane/Desktop/test-01/sourcemap-hj0/a.js'</span><span class="token punctuation">,</span>
  <span class="token string">'--a'</span><span class="token punctuation">,</span>
  <span class="token string">'b'</span><span class="token punctuation">,</span>
  <span class="token string">'c'</span>
<span class="token punctuation">]</span>
</code></pre></div><p>使用 <em>minimist</em> 格式化参数</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 执行</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">minimist</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// 结果</span>
<span class="token punctuation">{</span>
  _<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">'/Users/jane/.nvm/versions/node/v14.17.4/bin/node'</span><span class="token punctuation">,</span>
    <span class="token string">'/Users/jane/Desktop/test-01/sourcemap-hj0/a.js'</span><span class="token punctuation">,</span>
    <span class="token string">'c'</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  a<span class="token operator">:</span> <span class="token string">'b'</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:100px;"></div> <h2 id="可复用和组合"><a href="#可复用和组合" class="header-anchor">#</a> 可复用和组合</h2> <h3 id="vca"><a href="#vca" class="header-anchor">#</a> VCA</h3> <h4 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h4> <p>将同一个逻辑关注点相关代码收集在一起，对于组织大型项目代码会非常友好。通过 <code>VCA</code> 这种方式可以进行代码的复用 <a href="https://juejin.cn/post/6850418114111537159" target="_blank" rel="noopener noreferrer">VCA扫盲<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p><div style="margin-top:30px;"></div><p></p> <h4 id="用法"><a href="#用法" class="header-anchor">#</a> 用法</h4> <p>可以看到，写出来的就像一个函数似的，然后在组件中调用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/composables/useUserRepositories.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fetchUserRepositories <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/api/repositories'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ref<span class="token punctuation">,</span> onMounted<span class="token punctuation">,</span> watch <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">useUserRepositories</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> repositories <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token function-variable function">getUserRepositories</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUserRepositories</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token function">onMounted</span><span class="token punctuation">(</span>getUserRepositories<span class="token punctuation">)</span>
  <span class="token function">watch</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> getUserRepositories<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    repositories<span class="token punctuation">,</span>
    getUserRepositories
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/components/UserRepositories.vue</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> toRefs <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> useUserRepositories <span class="token keyword">from</span> <span class="token string">'@/composables/useUserRepositories'</span>
<span class="token keyword">import</span> useRepositoryNameSearch <span class="token keyword">from</span> <span class="token string">'@/composables/useRepositoryNameSearch'</span>
<span class="token keyword">import</span> useRepositoryFilters <span class="token keyword">from</span> <span class="token string">'@/composables/useRepositoryFilters'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  components<span class="token operator">:</span> <span class="token punctuation">{</span> RepositoriesFilters<span class="token punctuation">,</span> RepositoriesSortBy<span class="token punctuation">,</span> RepositoriesList <span class="token punctuation">}</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">{</span>
    user<span class="token operator">:</span> <span class="token punctuation">{</span>
      type<span class="token operator">:</span> String<span class="token punctuation">,</span>
      required<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">setup</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> user <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">toRefs</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> repositories<span class="token punctuation">,</span> getUserRepositories <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useUserRepositories</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      searchQuery<span class="token punctuation">,</span>
      repositoriesMatchingSearchQuery
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRepositoryNameSearch</span><span class="token punctuation">(</span>repositories<span class="token punctuation">)</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span>
      filters<span class="token punctuation">,</span>
      updateFilters<span class="token punctuation">,</span>
      filteredRepositories
    <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useRepositoryFilters</span><span class="token punctuation">(</span>repositoriesMatchingSearchQuery<span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token comment">// 因为我们并不关心未经过滤的仓库</span>
      <span class="token comment">// 我们可以在 `repositories` 名称下暴露过滤后的结果</span>
      repositories<span class="token operator">:</span> filteredRepositories<span class="token punctuation">,</span>
      getUserRepositories<span class="token punctuation">,</span>
      searchQuery<span class="token punctuation">,</span>
      filters<span class="token punctuation">,</span>
      updateFilters
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="函数式组件"><a href="#函数式组件" class="header-anchor">#</a> 函数式组件</h3> <h4 id="简介-2"><a href="#简介-2" class="header-anchor">#</a> 简介</h4> <p>函数式组件是自身没有任何状态的组件的另一种形式。它们在渲染过程中不会创建组件实例，并跳过常规的组件生命周期。可以把函数式组件想像成组件里的一个函数，入参是渲染上下文(render context)，返回值是渲染好的 <code>HTML</code><a href="https://v3.cn.vuejs.org/guide/render-function.html#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BB%84%E4%BB%B6" target="_blank" rel="noopener noreferrer">函数式组件扫盲<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p><div style="margin-top:30px;"></div><p></p> <h4 id="用法-2"><a href="#用法-2" class="header-anchor">#</a> 用法</h4> <p><a href="https://v3.cn.vuejs.org/guide/migration/functional-components.html#%E6%A6%82%E8%A7%88" target="_blank" rel="noopener noreferrer">其他用法<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// Vue 2 函数式组件示例 xxx.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  functional<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  props<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'level'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">h<span class="token punctuation">,</span> <span class="token punctuation">{</span> props<span class="token punctuation">,</span> data<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">h</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">h</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>props<span class="token punctuation">.</span>level<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> data<span class="token punctuation">,</span> children<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>举个例子</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app.vue</span>
<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>FunctionalButton @click<span class="token operator">=</span><span class="token string">&quot;log&quot;</span><span class="token operator">&gt;</span>
    Click me
  <span class="token operator">&lt;</span><span class="token operator">/</span>FunctionalButton<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>template<span class="token operator">&gt;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// FunctionalButton.js</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  functional<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">createElement<span class="token punctuation">,</span> <span class="token punctuation">{</span> props<span class="token punctuation">,</span> listeners<span class="token punctuation">,</span> children <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span>
      <span class="token string">'button'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        attrs<span class="token operator">:</span> props<span class="token punctuation">,</span>
        on<span class="token operator">:</span> <span class="token punctuation">{</span>
          click<span class="token operator">:</span> listeners<span class="token punctuation">.</span>click
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      children
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="渲染函数-jsx"><a href="#渲染函数-jsx" class="header-anchor">#</a> 渲染函数 &amp; JSX</h3> <h4 id="简介-3"><a href="#简介-3" class="header-anchor">#</a> 简介</h4> <p>用 <code>js</code> 的方式来渲染 <code>html</code> 文件，<a href="https://v3.cn.vuejs.org/guide/render-function.html#dom-%E6%A0%91" target="_blank" rel="noopener noreferrer">详情<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p><div style="margin-top:30px;"></div><p></p> <h4 id="用法-3"><a href="#用法-3" class="header-anchor">#</a> 用法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 模版文件</span>
<span class="token operator">&lt;</span>anchored<span class="token operator">-</span>heading <span class="token operator">:</span>level<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> world<span class="token operator">!</span> <span class="token operator">&lt;</span><span class="token operator">/</span>anchored<span class="token operator">-</span>heading<span class="token operator">&gt;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token function">h</span><span class="token punctuation">(</span>
  <span class="token string">'anchored-heading'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    level<span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token function-variable function">default</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">[</span><span class="token function">h</span><span class="token punctuation">(</span><span class="token string">'span'</span><span class="token punctuation">,</span> <span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">' world!'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre></div><p>上述模板如此简单的情况下，渲染函数写起来比较痛苦，期望能有更接近模版的渲染写法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> AnchoredHeading <span class="token keyword">from</span> <span class="token string">'./AnchoredHeading.vue'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>AnchoredHeading level<span class="token operator">=</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>span<span class="token operator">&gt;</span>Hello<span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span> world<span class="token operator">!</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>AnchoredHeading<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#demo'</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="mixin"><a href="#mixin" class="header-anchor">#</a> mixin</h3> <h4 id="简介-4"><a href="#简介-4" class="header-anchor">#</a> 简介</h4> <p><code>Mixin</code> 提供了一种非常灵活的方式，来分发 <code>Vue</code> 组件中的可复用功能。一个 <code>mixin</code> 对象可以包含任意组件选项。当组件使用 <code>mixin</code> 对象时，所有 <code>mixin</code> 对象的选项将被“混合”进入该组件本身的选项。<a href="https://v3.cn.vuejs.org/guide/mixins.html#%E5%9F%BA%E7%A1%80" target="_blank" rel="noopener noreferrer">详情<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p><div style="margin-top:30px;"></div><p></p> <h4 id="用法-4"><a href="#用法-4" class="header-anchor">#</a> 用法</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// define a mixin object</span>
<span class="token keyword">const</span> myMixin <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hello from mixin!'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// define an app that uses this mixin</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> Vue<span class="token punctuation">.</span><span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  mixins<span class="token operator">:</span> <span class="token punctuation">[</span>myMixin<span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#mixins-basic'</span><span class="token punctuation">)</span> <span class="token comment">// =&gt; &quot;hello from mixin!&quot;</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="问题"><a href="#问题" class="header-anchor">#</a> 问题</h4> <ul><li>渲染上下文中暴露的 <code>property</code> 来源不清晰。例如在阅读一个运用了多个 <code>mixin</code> 的模板时，很难看出某个 <code>property</code> 是从哪一个 <code>mixin</code> 中注入的。</li> <li>命名空间冲突：<code>Mixin</code> 之间的 <code>property</code> 和方法可能有冲突，同时高阶组件也可能和预期的 <code>prop</code> 有命名冲突。
<div style="margin-top:50px;"></div></li></ul> <h3 id="vue-hooks"><a href="#vue-hooks" class="header-anchor">#</a> vue-hooks</h3> <h4 id="简介-5"><a href="#简介-5" class="header-anchor">#</a> 简介</h4> <p><code>Hooks</code> 实现了 <code>mixins</code> 的功能，但避免了 <code>mixins</code> 带来的两个主要问题：</p> <ul><li>允许相互传递状态</li> <li>明确指出逻辑来自哪里</li> <li>避免产生冲突
<br>感觉和<code>VCA</code> 的目标是一样的，像是一个试验性的方案，没有找到这两个直接的概念区别，暂时理解为 <code>VCA</code>，
<div style="margin-top:30px;"></div></li></ul> <h4 id="用法-5"><a href="#用法-5" class="header-anchor">#</a> 用法</h4> <p><a href="https://juejin.cn/post/6844903784598994952" target="_blank" rel="noopener noreferrer">用法示例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div style="margin-top:100px;"></div> <h2 id="组件库"><a href="#组件库" class="header-anchor">#</a> 组件库</h2> <h3 id="简介-6"><a href="#简介-6" class="header-anchor">#</a> 简介</h3> <p>组件库本质上是一种 <code>npm</code> 包，针对可复用的组件做的一种打包工作
</p><div style="margin-top:50px;"></div><p></p> <h3 id="开发"><a href="#开发" class="header-anchor">#</a> 开发</h3> <h4 id="webpack-入口文件"><a href="#webpack-入口文件" class="header-anchor">#</a> webpack 入口文件</h4> <ol><li>对于多 <code>package</code> 模式（src/packages），这是整体的入口文件</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> Index <span class="token keyword">from</span> <span class="token string">'./packages/demo/index.js'</span>
<span class="token keyword">const</span> components <span class="token operator">=</span> <span class="token punctuation">[</span>Index<span class="token punctuation">]</span>
<span class="token keyword">const</span> <span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  components<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>install<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>name<span class="token punctuation">,</span> item<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 自动安装 方便打包成压缩文件, 用&lt;script scr=''&gt;&lt;/script&gt;的方式引用</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">install</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span>Vue<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// 注意这种导出方式，后面会说到</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  install<span class="token punctuation">,</span>
  Index<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>单个 <code>pacakge</code> 打包入口文件：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> MyComponent1 <span class="token keyword">from</span> <span class="token string">'./index.vue'</span>

<span class="token comment">/* istanbul ignore next */</span>
MyComponent1<span class="token punctuation">.</span><span class="token function-variable function">install</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">Vue</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Vue<span class="token punctuation">.</span><span class="token function">component</span><span class="token punctuation">(</span>MyComponent1<span class="token punctuation">.</span>name<span class="token punctuation">,</span> MyComponent1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> MyComponent1
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="引入方式"><a href="#引入方式" class="header-anchor">#</a> 引入方式</h3> <h4 id="按需引入单个包"><a href="#按需引入单个包" class="header-anchor">#</a> 按需引入单个包</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> MyCompList <span class="token keyword">from</span> '@nibfe<span class="token operator">/</span>pattern<span class="token operator">-</span>select<span class="token operator">/</span>build<span class="token operator">/</span>es<span class="token operator">/</span>packages<span class="token operator">/</span>parttern<span class="token operator">-</span>list<span class="token operator">/</span>index<span class="token punctuation">.</span>js’<span class="token punctuation">.</span> 
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyCompList<span class="token punctuation">)</span>
</code></pre></div><h4 id="引入全部包"><a href="#引入全部包" class="header-anchor">#</a> 引入全部包</h4> <p>这种引入方式一定要保证在 1 中的入口文件中包含要引入的组件，如 <code>Index</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> MyComp <span class="token keyword">from</span> <span class="token string">'@nibfe/pattern-select'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyComp<span class="token punctuation">)</span>
</code></pre></div><h4 id="按需引入"><a href="#按需引入" class="header-anchor">#</a> 按需引入</h4> <p><strong>1中export default</strong> 的导出方式不能用 {} 的方式引入，必须用 <code>export</code> 的方式导出才能用 {} 导入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MyComp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@nibfe/pattern-select'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>MyComp<span class="token punctuation">)</span>
</code></pre></div><p>如果想要用 {} 按需引入的方式，那就必须要引入 <code>babel-plugin-import</code></p> <div class="language-js extra-class"><pre class="language-js"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  presets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@vue/app'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  plugins<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span>
      <span class="token string">'import'</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        libraryName<span class="token operator">:</span> <span class="token string">'@nibfe/vault'</span><span class="token punctuation">,</span>
        <span class="token function">customStyleName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">@nibfe/vault/build/styles/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.css</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">customName</span><span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">@nibfe/vault/build/es/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.js</span><span class="token template-punctuation string">`</span></span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="组件库打包"><a href="#组件库打包" class="header-anchor">#</a> 组件库打包</h3> <p>打包工具用的是 <code>rollup</code>。打包方法 <code>CJS, AMD, UMD 和 ESM</code>, 其中 <code>AMD</code> 说的异步是下载时不会阻塞其他进程，就像是 <code>script</code> 中的 <code>async</code>。具体详细看👇下面链接
</p><div style="margin-top:50px;"></div><p></p> <h3 id="引入第三方库"><a href="#引入第三方库" class="header-anchor">#</a> 引入第三方库</h3> <p>需要注意的是，如果想要按需引入，必须打包的结果中有按单包打包的，也有整体打包的结果。这就是为什么 <code>packages</code> 目录外有 <code>index.js</code> 入口文件，子目录中也有入口文件的原因。那么该如何引入第三方库呢，如果是局部引入，在 <code>packages</code> 子包的 <code>.vue</code> 中引入即可。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/packages/xx/index.vue</span>
<span class="token keyword">import</span> <span class="token string">'@ss/mtd-vue/lib/theme2/index.css'</span>

<span class="token comment">// 按需引入</span>
<span class="token keyword">import</span> a <span class="token keyword">from</span> <span class="token string">'../build/es/packages/demo/index.js'</span>
</code></pre></div><p>如果是全局引入，必须在全局的打包入口文件中（src/index.js）中引入，打包出的结果也只能全局引入，不能按需引入，因为在按需打包的文件中不会包含全局的文件。注意：<code>entry/main</code> 中是测试文件，方便本地测试组件库的，不会写入到最后的打包结果中</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// src/index.js</span>
<span class="token keyword">import</span> <span class="token string">'@ss/mtd-vue/lib/theme2/index.css'</span>

<span class="token comment">// 打包结果引入，全局引入</span>
<span class="token keyword">import</span> a <span class="token keyword">from</span> <span class="token string">'../build/es/index.es'</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
</code></pre></div><p>为了防止第三方库二次打包（原包打包过一次），需要在组件库打包的时候排除掉</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue.config.js</span>
pluginOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
  romeLibrary<span class="token operator">:</span> <span class="token punctuation">{</span>
    rollupOptions<span class="token operator">:</span> <span class="token punctuation">{</span>
      external<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@ss\/mtd-vue</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">@nibfe\/dz-form</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 此处举例,其中/@gfe/,/@hfe/是通过正则的方式匹配，'@/lib/axios'字符串方式是匹配同名第三方包</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="🔗相关链接"><a href="#🔗相关链接" class="header-anchor">#</a> 🔗相关链接</h3> <ul><li><a href="https://www.npmjs.com/package/babel-plugin-import" target="_blank" rel="noopener noreferrer">babel-plugin-import<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903459536240648" target="_blank" rel="noopener noreferrer">手把手教你开发组件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6905708824703795214" target="_blank" rel="noopener noreferrer">简单实现 babel-plugin-import<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6935973925004247077" target="_blank" rel="noopener noreferrer">CJS, AMD, UMD 和 ESM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="http://www.360doc.com/content/19/0519/15/13328254_836725029.shtml" target="_blank" rel="noopener noreferrer">AMD、CJS<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844903735236247565" target="_blank" rel="noopener noreferrer">webpack和rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.rollupjs.com/" target="_blank" rel="noopener noreferrer">rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.cjw.design/blog/old/rollup#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E9%80%89%E9%A1%B9%E8%AF%A6%E8%A7%A3" target="_blank" rel="noopener noreferrer">rollup配置文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div style="margin-top:100px;"></div> <h2 id="generatorapi"><a href="#generatorapi" class="header-anchor">#</a> GeneratorAPI</h2> <h3 id="简介-7"><a href="#简介-7" class="header-anchor">#</a> 简介</h3> <p>插件的 <code>Generator</code> 部分通常在你想要为项目扩展包依赖，创建新的文件或者编辑已经存在的文件时需要。</p> <p>在 <code>CLI</code> 插件内部，<code>generator</code> 应该放在 <code>generator.js</code> 或者 <code>generator/index.js</code> 文件中。它将在以下两个场景被调用：</p> <p>项目初始创建期间，<code>CLI</code> 插件被作为项目创建 <code>preset</code> 的一部分被安装时。</p> <p>当插件在项目创建完成和通过 <code>vue add</code> 或者 <code>vue invoke</code> 单独调用被安装时。</p> <p>一个 <code>generator</code> 应该导出一个接收三个参数的函数：</p> <p>一个 <code>GeneratorAPI</code> 实例；</p> <p>插件的 <code>generator</code> 选项。这些选项在项目创建，或者从 <code>~/.vuerc</code>载入预设时被解析。例如：如果保存的 <code>~/.vuerc</code> 像这样：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;presets&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;foo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;plugins&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token string">&quot;@vue/cli-plugin-foo&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string">&quot;option&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bar&quot;</span> <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果用户使用 <code>preset foo</code> 创建了一个项目，那么 <code>@vue/cli-plugin-foo</code> 的 <code>generator</code> 就会收到 <code>{ option: 'bar' }</code>作为第二个参数。
</p><div style="margin-top:50px;"></div><p></p> <h3 id="常用-api"><a href="#常用-api" class="header-anchor">#</a> 常用 API</h3> <h4 id="cliversion"><a href="#cliversion" class="header-anchor">#</a> cliVersion</h4> <p>The version string for the global @vue/cli version that is invoking the plugin.
</p><div style="margin-top:30px;"></div><p></p> <h4 id="assertcliversion"><a href="#assertcliversion" class="header-anchor">#</a> assertCliVersion</h4> <p>{integer | string} range - a semver range that @vue/cli needs to satisfy
</p><div style="margin-top:30px;"></div><p></p> <h4 id="cliserviceversion"><a href="#cliserviceversion" class="header-anchor">#</a> cliServiceVersion</h4> <p>The version string for the project local @vue/cli-service version that is invoking the plugin.
</p><div style="margin-top:30px;"></div><p></p> <h4 id="assertcliserviceversion"><a href="#assertcliserviceversion" class="header-anchor">#</a> assertCliServiceVersion</h4> <p>{integer | string} range - a semver range that @vue/cli-service needs to satisfy
</p><div style="margin-top:30px;"></div><p></p> <h4 id="resolve"><a href="#resolve" class="header-anchor">#</a> resolve</h4> <p>Resolve a path for the current project
</p><div style="margin-top:30px;"></div><p></p> <h4 id="hasplugin"><a href="#hasplugin" class="header-anchor">#</a> hasPlugin</h4> <p>Check if the project has a plugin with given id. If version range is given, then the plugin version should satisfy it, 第二个参数可以输入版本号
</p><div style="margin-top:30px;"></div><p></p> <h4 id="extendpackage"><a href="#extendpackage" class="header-anchor">#</a> extendPackage</h4> <p>拓展 <code>package.json</code> 配置</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">extendPackage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  scripts<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'serve'</span><span class="token operator">:</span> <span class="token string">'vue-cli-service serve'</span><span class="token punctuation">,</span>
    <span class="token string">'build'</span><span class="token operator">:</span> <span class="token string">'vue-cli-service build'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  dependencies<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">'vue'</span><span class="token operator">:</span> <span class="token string">'^2.5.17'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="render"><a href="#render" class="header-anchor">#</a> render</h4> <p>利用 <code>ejs</code> 渲染模板文件</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token string">'./template'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  doesCompile<span class="token operator">:</span> api<span class="token punctuation">.</span><span class="token function">hasPlugin</span><span class="token punctuation">(</span><span class="token string">'babel'</span><span class="token punctuation">)</span> <span class="token operator">||</span> api<span class="token punctuation">.</span><span class="token function">hasPlugin</span><span class="token punctuation">(</span><span class="token string">'typescript'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="postprocessfiles"><a href="#postprocessfiles" class="header-anchor">#</a> postProcessFiles</h4> <p><code>push</code> 一个文件中间件，它将在所有普通中间件都执行完成后再执行</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">postProcessFiles</span><span class="token punctuation">(</span><span class="token parameter">files</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token comment">// postProcessFilesCbs 是在所有普通文件在内存中渲染成字符串完成之后要执行的遍历回调</span>
<span class="token function">postProcessFiles</span> <span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>generator<span class="token punctuation">.</span>postProcessFilesCbs<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>cb<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="oncreatecomplete"><a href="#oncreatecomplete" class="header-anchor">#</a> onCreateComplete</h4> <p>内存中保存的文件字符串全部被写入文件后的回调函数</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">onCreateComplete</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="exitlog"><a href="#exitlog" class="header-anchor">#</a> exitLog</h4> <p>当 <code>generator</code> 退出的时候输出的信息</p> <p><code>{('log'|'info'|'done'|'warn'|'error')} [type='log'] - type of the message</code></p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">exitLog</span><span class="token punctuation">(</span><span class="token string">'为了更好的开发，请在本地 /etc/hosts 中配置 local.sankuai.com 指向 127.0.0.1'</span><span class="token punctuation">,</span> <span class="token string">'info'</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="genjsconfig"><a href="#genjsconfig" class="header-anchor">#</a> genJSConfig</h4> <p>将 <code>json</code> 文件生成为 <code>js</code> 配置文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> utilsFactory <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@nibfe/vue-cli-shared-utils'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> utils <span class="token operator">=</span> <span class="token function">utilsFactory</span><span class="token punctuation">(</span>api<span class="token punctuation">)</span>
<span class="token keyword">const</span> eslintRcTargetPath <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'.eslintrc.js'</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isVueCli3<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> utils<span class="token punctuation">.</span><span class="token function">generateFile</span><span class="token punctuation">(</span>eslintRcTargetPath<span class="token punctuation">,</span> api<span class="token punctuation">.</span><span class="token function">genJSConfig</span><span class="token punctuation">(</span>eslintConfig<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="makejsonlyvalue"><a href="#makejsonlyvalue" class="header-anchor">#</a> makeJSOnlyValue</h4> <p>Turns a string expression into executable JS for .js config files</p> <div class="language-js extra-class"><pre class="language-js"><code>eslintConfig <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// cache origin eslintConfig</span>
  <span class="token operator">...</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>pkg<span class="token punctuation">.</span>eslintConfig <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token punctuation">(</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>pkg<span class="token punctuation">.</span>eslintConfig <span class="token operator">&amp;&amp;</span> api<span class="token punctuation">.</span>generator<span class="token punctuation">.</span>pkg<span class="token punctuation">.</span>eslintConfig<span class="token punctuation">.</span>rules<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'no-console'</span><span class="token operator">:</span> api<span class="token punctuation">.</span><span class="token function">makeJSOnlyValue</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">process.env.NODE_ENV === 'production' ? 'error' : 'off'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string">'no-debugger'</span><span class="token operator">:</span> api<span class="token punctuation">.</span><span class="token function">makeJSOnlyValue</span><span class="token punctuation">(</span>
      <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">process.env.NODE_ENV === 'production' ? 'error' : 'off'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="injectimports"><a href="#injectimports" class="header-anchor">#</a> injectImports</h4> <p>向文件当中注入 <code>import</code> 语法的方法</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">injectImports</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">import '@/plugins/axios'</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="injectrootoptions"><a href="#injectrootoptions" class="header-anchor">#</a> injectRootOptions</h4> <p>向 <code>Vue</code> 根实例中添加选项</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">injectRootOptions</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>entryFile<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">store</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="entryfile"><a href="#entryfile" class="header-anchor">#</a> entryFile</h4> <p>Get the entry file taking into account typescript, 如 {('src/main.ts'|'src/main.js')}</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span>entryFile
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="invoking"><a href="#invoking" class="header-anchor">#</a> invoking</h4> <p>Checks if the plugin is being invoked</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span>invoking
</code></pre></div><h4 id="addconfigtransform"><a href="#addconfigtransform" class="header-anchor">#</a> addConfigTransform</h4> <p>插件通过 <code>GeneratorAPI</code> 暴露的 <code>addConfigTransform</code> 方法添加如何提取配置文件, 一般用于从 <code>package.json</code> 中提取配置到如 <code>vue.config.js</code> 此类的专用文件中</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>{string} key - config key in package.json</li> <li>{object} options - options</li> <li>{object} options.file - file descriptor. Used to search for existing file. Each key is a file type (possible values: ['js', 'json', 'yaml', 'lines']). The value is a list of filenames</li></ul></div> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">addConfigTransform</span><span class="token punctuation">(</span><span class="token string">'fooConfig'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  file<span class="token operator">:</span> <span class="token punctuation">{</span>
    json<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'foo.config.json'</span><span class="token punctuation">]</span> <span class="token comment">// 提取到该配置文件中</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="🔗相关链接-2"><a href="#🔗相关链接-2" class="header-anchor">#</a> 🔗相关链接</h3> <ul><li><a href="https://cli.vuejs.org/dev-guide/generator-api.html#injectimports" target="_blank" rel="noopener noreferrer">generatorAPI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://kuangpf.com/vue-cli-analysis/create/generator.html" target="_blank" rel="noopener noreferrer">vue analysis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904154461126670" target="_blank" rel="noopener noreferrer">postProcessFiles<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904154461126670" target="_blank" rel="noopener noreferrer">vue cli源码探索<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div style="margin-top:100px;"></div> <h2 id="history-和-hash-模式"><a href="#history-和-hash-模式" class="header-anchor">#</a> history 和 hash 模式</h2> <h3 id="简介-8"><a href="#简介-8" class="header-anchor">#</a> 简介</h3> <p><code>vue</code> 是渐进式前端开发框架，为了实现 <code>SPA</code> ，需要引入前端路由系统（<code>vue-router</code>）。前端路由的核心是：改变视图的同时不会向后端发出请求。为了达到这一目的，浏览器提供了 <code>hash</code> 和 <code>history</code> 两种模式。</p> <p><code>hash</code> 虽然出现在 <code>URL</code> 中，但不会被包含在 <code>http</code> 请求中，对后端完全没有影响，因此改变 <code>hash</code> 不会重新加载页面。</p> <p><code>history</code> 利用了 <code>html5 history interface</code> 中新增的 <code>pushState()</code> 和 <code>replaceState()</code> 方法。这两个方法应用于浏览器记录栈，在当前已有的 <code>back、forward、go</code> 基础之上，它们提供了对历史记录修改的功能。只是当它们执行修改时，虽然改变了当前的 <code>URL</code> ，但浏览器不会立即向后端发送请求。因此可以说， <code>hash</code> 模式和 <code>history</code> 模式都属于浏览器自身的属性，<code>vue-router</code> 只是利用了这两个特性（通过调用浏览器提供的接口）来实现路由。
</p><div style="margin-top:50px;"></div><p></p> <h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3> <h4 id="_1-hash"><a href="#_1-hash" class="header-anchor">#</a> 1. hash</h4> <p><code>hash</code> 模式的原理是 <code>onhashchange</code> 事件，可以在 <code>window</code> 对象上监听这个事件。</p> <p><code>hash</code> 发生变化的 <code>url</code> 都会被浏览器记录下来，从而你会发现浏览器的前进后退都可以使用了，同时点击后退时，页面字体颜色也会发生变化。这样一来虽然没有向后端发送请求，但是页面状态和 <code>url</code> 关联在了一起，这就是前端路由</p> <div class="language-js extra-class"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function-variable function">onhashchange</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>oldURL<span class="token punctuation">,</span> event<span class="token punctuation">.</span>newURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> hash <span class="token operator">=</span> location<span class="token punctuation">.</span>hash<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> hash<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="_2-history"><a href="#_2-history" class="header-anchor">#</a> 2. history</h4> <p><code>hashchange</code> 只能改变 <strong>#</strong> 后面的代码片段，<code>history api （pushState、replaceState、go、back、forward）</code> 则给了前端完全的自由，通过在 <code>window</code> 对象上监听 <code>popState()</code> 事件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token function">、replaceState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> 方法接收三个参数：stateObj、title、url。

<span class="token comment">// 设置状态</span>
history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>color<span class="token operator">:</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 监听状态</span>
window<span class="token punctuation">.</span><span class="token function-variable function">onpopstate</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>state <span class="token operator">&amp;&amp;</span> event<span class="token punctuation">.</span>state<span class="token punctuation">.</span>color <span class="token operator">===</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>color <span class="token operator">=</span> <span class="token string">&quot;red&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 改变状态</span>
history<span class="token punctuation">.</span><span class="token function">back</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
history<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过 <code>pushState</code> 把页面的状态保存在 <code>state</code> 对象中，当页面的 <code>url</code> 再变回到这个 <code>url</code> 时，可以通过 <code>event.state</code> 取到这个 <code>state</code> 对象，从而可以对页面状态进行还原，如页面滚动条的位置、阅读进度、组件的开关等</p> <div style="margin-top:50px;"></div> <h3 id="🔗相关链接-3"><a href="#🔗相关链接-3" class="header-anchor">#</a> 🔗相关链接</h3> <ul><li><a href="https://juejin.cn/post/6844903625169502216" target="_blank" rel="noopener noreferrer">history和hash模式的区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/Charissa2017/article/details/104779412" target="_blank" rel="noopener noreferrer">history和hash模式详解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.jianshu.com/p/bb5f9263e169" target="_blank" rel="noopener noreferrer">replaceState和pushState的区别<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div style="margin-top:100px;"></div> <h2 id="browser-module-main-字段"><a href="#browser-module-main-字段" class="header-anchor">#</a> browser，module，main 字段</h2> <h3 id="简介-9"><a href="#简介-9" class="header-anchor">#</a> 简介</h3> <p>前端开发中使用到 <code>npm</code> 包那可算是家常便饭，而使用到 <code>npm</code> 包总免不了接触到 <code>package.json</code> 包配置文件。</p> <p>那么这里就有一个问题，当我们在不同环境下 <code>import</code> 一个 <code>npm</code> 包时，到底加载的是 <code>npm</code> 包的哪个文件？</p> <p>老司机们很快地给出答案：<code>main</code> 字段中指定的文件。</p> <p>然而我们清楚 <code>npm</code> 包其实又分为：只允许在客户端使用的，只允许造服务端使用的，浏览器/服务端都可以使用。
如果我们需要开发一个 <code>npm</code> 包同时兼容支持 <code>web</code> 端 和 <code>server</code> 端，需要在不同环境下加载 <code>npm</code> 包不同的入口文件，显然一个 <code>main</code> 字段已经不能够满足我们的需求，这就衍生出来了 <code>module</code> 与 <code>browser</code> 字段。</p> <p>本文就来说下 这几个字段的使用场景，以及同时存在这几个字段时，他们之间的优先级。
</p><div style="margin-top:50px;"></div><p></p> <h3 id="🔗相关链接-4"><a href="#🔗相关链接-4" class="header-anchor">#</a> 🔗相关链接</h3> <ul><li><a href="https://github.com/SunshowerC/blog/issues/8" target="_blank" rel="noopener noreferrer">package.json 中 你还不清楚的 browser，module，main 字段优先级 #8
<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div style="margin-top:100px;"></div> <h2 id="pluginapi"><a href="#pluginapi" class="header-anchor">#</a> pluginAPI</h2> <h3 id="简介-10"><a href="#简介-10" class="header-anchor">#</a> 简介</h3> <p><code>Service</code> 插件可以修改 <code>webpack</code> 配置，创建新的 <code>vue-cli service</code> 命令或者修改已经存在的命令（如 <code>serve</code> 和 <code>build</code>）。</p> <p><code>Service</code> 插件在 <code>Service</code> 实例被创建后自动加载 - 例如，每次 <code>vue-cli-service</code> 命令在项目中被调用的时候。它位于 <code>CLI</code> 插件根目录的 <code>index.js</code> 文件。</p> <p>一个 <code>service</code> 插件应该导出一个函数，这个函数接受两个参数：</p> <p>一个 <code>PluginAPI</code> 实例</p> <p>一个包含 <code>vue.config.js</code> 内指定的项目本地选项的对象，或者在 <code>package.json</code> 内的 <code>vue</code> 字段。
</p><div style="margin-top:50px;"></div><p></p> <h3 id="常用api"><a href="#常用api" class="header-anchor">#</a> 常用API</h3> <h4 id="version"><a href="#version" class="header-anchor">#</a> version</h4> <p>加载该插件的 <code>@vue/cli-service</code> 版本</p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span>version
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="assertversion"><a href="#assertversion" class="header-anchor">#</a> assertVersion</h4> <p>需要满足的 <code>@vue/cli-service</code> 的版本，入参为 <code>string</code> 或 <code>integer</code></p> <div class="language-js extra-class"><pre class="language-js"><code>api<span class="token punctuation">.</span><span class="token function">assertVersion</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="getcwd"><a href="#getcwd" class="header-anchor">#</a> getCwd</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">getCwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">getCwd</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>context
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="resolve-2"><a href="#resolve-2" class="header-anchor">#</a> resolve</h4> <p>相对于根目录的绝对路径</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">resolve</span> <span class="token punctuation">(</span><span class="token parameter">_path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>context<span class="token punctuation">,</span> _path<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="hasplugin-2"><a href="#hasplugin-2" class="header-anchor">#</a> hasPlugin</h4> <p>是否包含某个插件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">hasPlugin</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">hasPlugin</span> <span class="token punctuation">(</span><span class="token parameter">id</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">===</span> <span class="token string">'router'</span><span class="token punctuation">)</span> id <span class="token operator">=</span> <span class="token string">'vue-router'</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'vue-router'</span><span class="token punctuation">,</span> <span class="token string">'vuex'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>pkg
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>dependencies <span class="token operator">&amp;&amp;</span> pkg<span class="token punctuation">.</span>dependencies<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>pkg<span class="token punctuation">.</span>devDependencies <span class="token operator">&amp;&amp;</span> pkg<span class="token punctuation">.</span>devDependencies<span class="token punctuation">[</span>id<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token parameter">p</span> <span class="token operator">=&gt;</span> <span class="token function">matchesPluginId</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> p<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="registercommand"><a href="#registercommand" class="header-anchor">#</a> registerCommand</h4> <p>注册 <code>cli</code> 命令服务，<code>options</code> 为一个包含 <code>vue.config.js</code> 内指定的项目本地选项的对象，或者在 <code>package.json</code> 内的 <code>vue</code> 字段</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">registerCommand</span><span class="token punctuation">(</span><span class="token string">'addPage'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token parameter">args</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">addPage</span><span class="token punctuation">(</span>api<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">registerCommand</span> <span class="token punctuation">(</span><span class="token parameter">name<span class="token punctuation">,</span> opts<span class="token punctuation">,</span> fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> opts <span class="token operator">===</span> <span class="token string">'function'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fn <span class="token operator">=</span> opts
    opts <span class="token operator">=</span> <span class="token keyword">null</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>commands<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> fn<span class="token punctuation">,</span> opts<span class="token operator">:</span> opts <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="chainwebpack"><a href="#chainwebpack" class="header-anchor">#</a> chainWebpack</h4> <p>通过 <code>webpack-chain</code> 修改 <code>webpack</code> 配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span><span class="token function">devtool</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">chainWebpack</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>webpackChainFns<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="configurewebpack"><a href="#configurewebpack" class="header-anchor">#</a> configureWebpack</h4> <p>通过 <code>webpack-merge</code> 对 <code>webpack</code> 配置进行合并</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
api<span class="token punctuation">.</span><span class="token function">configureWebpack</span><span class="token punctuation">(</span><span class="token parameter">config</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  config<span class="token punctuation">.</span>devtool <span class="token operator">=</span> <span class="token string">'eval-source-map'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 原理</span>
<span class="token function">configureWebpack</span> <span class="token punctuation">(</span><span class="token parameter">fn</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span>webpackRawConfigFns<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:30px;"></div> <h4 id="configuredevserver"><a href="#configuredevserver" class="header-anchor">#</a> configureDevServer</h4> <p>Register a dev serve config function. It will receive the express app instance of the dev server.
</p><div style="margin-top:30px;"></div><p></p> <h4 id="resolvewebpackconfig"><a href="#resolvewebpackconfig" class="header-anchor">#</a> resolveWebpackConfig</h4> <p>调用之前通过 <code>chainWebpack</code> 和 <code>configureWebpack</code> 上完成的对于 <code>webpack</code> 配置的改造，并返回最终的 <code>webpack</code> 配置
</p><div style="margin-top:30px;"></div><p></p> <h4 id="resolvechainablewebpackconfig"><a href="#resolvechainablewebpackconfig" class="header-anchor">#</a> resolveChainableWebpackConfig</h4> <p>Resolve an intermediate chainable webpack config instance, which can be further tweaked before generating the final raw webpack config. You can call this multiple times to generate different branches of the base webpack config.
</p><div style="margin-top:30px;"></div><p></p> <h4 id="gencacheconfig"><a href="#gencacheconfig" class="header-anchor">#</a> genCacheConfig</h4> <p>Generate a cache identifier from a number of variables，返回 <code>cacheDirectory, cacheIdentifier(一个缓存标志)</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 用法</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> cacheIdentifier <span class="token punctuation">}</span> <span class="token operator">=</span> api<span class="token punctuation">.</span><span class="token function">genCacheConfig</span><span class="token punctuation">(</span>
  <span class="token string">'eslint-loader'</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    <span class="token string">'eslint-loader'</span><span class="token operator">:</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'eslint-loader/package.json'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>version<span class="token punctuation">,</span>
    eslint<span class="token operator">:</span> eslintPkg<span class="token punctuation">.</span>version
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>
    <span class="token string">'.eslintrc.js'</span><span class="token punctuation">,</span>
    <span class="token string">'.eslintrc.yaml'</span><span class="token punctuation">,</span>
    <span class="token string">'.eslintrc.yml'</span><span class="token punctuation">,</span>
    <span class="token string">'.eslintrc.json'</span><span class="token punctuation">,</span>
    <span class="token string">'.eslintrc'</span><span class="token punctuation">,</span>
    <span class="token string">'.eslintignore'</span><span class="token punctuation">,</span>
    <span class="token string">'package.json'</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">)</span>

api<span class="token punctuation">.</span><span class="token function">chainWebpack</span><span class="token punctuation">(</span><span class="token parameter">webpackConfig</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> lintOnSave <span class="token punctuation">}</span> <span class="token operator">=</span> options
  <span class="token keyword">const</span> allWarnings <span class="token operator">=</span> lintOnSave <span class="token operator">===</span> <span class="token boolean">true</span> <span class="token operator">||</span> lintOnSave <span class="token operator">===</span> <span class="token string">'warning'</span>
  <span class="token keyword">const</span> allErrors <span class="token operator">=</span> lintOnSave <span class="token operator">===</span> <span class="token string">'error'</span>

  webpackConfig<span class="token punctuation">.</span>module
    <span class="token punctuation">.</span><span class="token function">rule</span><span class="token punctuation">(</span><span class="token string">'eslint'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">pre</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>exclude
        <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'@vue/cli-service'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.(vue|(j|t)sx?)$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token string">'eslint-loader'</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">loader</span><span class="token punctuation">(</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">'eslint-loader'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          extensions<span class="token punctuation">,</span>
          cache<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>  <span class="token comment">// 保存检测结果到缓存中</span>
          cacheIdentifier<span class="token punctuation">,</span>  <span class="token comment">// 缓存标示</span>
          emitWarning<span class="token operator">:</span> allWarnings<span class="token punctuation">,</span>
          <span class="token comment">// only emit errors in production mode.</span>
          emitError<span class="token operator">:</span> allErrors<span class="token punctuation">,</span>
          eslintPath<span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>
            <span class="token function">resolveModule</span><span class="token punctuation">(</span><span class="token string">'eslint/package.json'</span><span class="token punctuation">,</span> cwd<span class="token punctuation">)</span> <span class="token operator">||</span>
            <span class="token function">resolveModule</span><span class="token punctuation">(</span><span class="token string">'eslint/package.json'</span><span class="token punctuation">,</span> __dirname<span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
          formatter<span class="token operator">:</span> <span class="token function">loadModule</span><span class="token punctuation">(</span><span class="token string">'eslint/lib/formatters/codeframe'</span><span class="token punctuation">,</span> cwd<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 原理</span>
<span class="token function">genCacheConfig</span> <span class="token punctuation">(</span><span class="token parameter">id<span class="token punctuation">,</span> partialIdentifier<span class="token punctuation">,</span> configFiles</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cacheDirectory <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">node_modules/.cache/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
  <span class="token keyword">const</span> variables <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 一些变量，此处省略</span>
  <span class="token keyword">const</span> cacheIdentifier <span class="token operator">=</span> <span class="token function">hash</span><span class="token punctuation">(</span>variables<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span> cacheDirectory<span class="token punctuation">,</span> cacheIdentifier <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:50px;"></div> <h3 id="🔗相关链接-5"><a href="#🔗相关链接-5" class="header-anchor">#</a> 🔗相关链接</h3> <ul><li><a href="https://cli.vuejs.org/dev-guide/plugin-api.html#resolvechainablewebpackconfig" target="_blank" rel="noopener noreferrer">pluginAPI<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://kuangpf.com/vue-cli-analysis/cli-service/service-run.html" target="_blank" rel="noopener noreferrer">vue analysis<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://juejin.cn/post/6844904154461126670" target="_blank" rel="noopener noreferrer">vue cli源码探索<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://segmentfault.com/a/1190000016244353" target="_blank" rel="noopener noreferrer">genCacheConfig<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://forum.vuejs.org/t/chainwebpack-configurewebpack/68750" target="_blank" rel="noopener noreferrer">chainWebpack与configureWebpack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://webpack.docschina.org/loaders/babel-loader/" target="_blank" rel="noopener noreferrer">cacheIdentifier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/eslint-loader" target="_blank" rel="noopener noreferrer">eslint-loader<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div style="margin-top:100px;"></div> <h2 id="loadmodule"><a href="#loadmodule" class="header-anchor">#</a> loadmodule</h2> <p><em>loadmodule</em> 可以直接获取到项目中的依赖版本，如果直接用 <em>require</em> 获取的是依赖中的子依赖</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> loadModule <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@vue/cli-shared-utils'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> pkg <span class="token operator">=</span> <span class="token function">loadModule</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/package.json</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> cwd<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><div style="margin-top:100px;"></div> <h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <p><em>eslint</em>、<em>stylelint</em>、<em>commitlint</em>、<em>cz</em>、<em>prettier</em> 等配置文件是我们在静态分析和提交代码时常用的检测工具，下面主要简单对比下这几种工具如何配置</p> <h3 id="_1-eslint"><a href="#_1-eslint" class="header-anchor">#</a> 1.eslint</h3> <p>配置优先级: .eslintrc.js &gt; .eslintrc.yaml &gt; .eslintrc.yml &gt; .eslintrc.json &gt; .eslintrc &gt; package.json <a href="https://eslint.bootcss.com/docs/user-guide/configuring" target="_blank" rel="noopener noreferrer">eslint config<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>可在 <em>package.json</em> 中配置:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mypackage&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0.0.1&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">&quot;env&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token string">&quot;browser&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
          <span class="token string">&quot;node&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;eslintIgnore&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;hello.js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;world.js&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果想将 <em>eslintConfig</em> 依赖收敛至 <em>package.json</em>，可以写成如下形式：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;eslintConfig&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span>
    <span class="token string">&quot;./node_modules/@xxx/xxx/dist/eslint.js&quot;</span> <span class="token comment">// 不加node_modules找不到文件</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意：<em>eslintIgnore</em> 如果直接收敛到 <em>eslint</em> 必须是数组的形式，不能以包的形式展示</p> <h3 id="_2-stylelint"><a href="#_2-stylelint" class="header-anchor">#</a> 2.stylelint</h3> <p>配置优先级: package.json &gt; .stylelintrc[|.json|.yaml|.js] &gt; stylelint.config.js     <a href="https://cloud.tencent.com/developer/section/1489626" target="_blank" rel="noopener noreferrer">stylelint<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>可在 <em>package.json</em> 中配置（无ignore字段）:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;stylelint&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@xxx/xxx/dist/stylelint&quot;</span> <span class="token comment">// 不加node_modules可以找到文件</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_3-prettier"><a href="#_3-prettier" class="header-anchor">#</a> 3.prettier</h3> <p>配置优先级：package.json &gt; .prettierrc &gt; .prettierrc.json &gt; .prettierrc.yaml &gt; .prettierrc.yml &gt; .prettierrc.js &gt; .prettier.config.js &gt; .prettierrc.toml  <a href="https://jsweibo.github.io/2019/10/17/Prettier%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" target="_blank" rel="noopener noreferrer">prettier<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>可在 <em>package.json</em> 中配置（无ignore字段）:</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@nibfe/rome-config/dist/prettier&quot;</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_4-commitlint"><a href="#_4-commitlint" class="header-anchor">#</a> 4.commitlint</h3> <p>在执行 <code>git commit</code> 时进行的提交信息检测 <a href="https://juejin.cn/post/6844903710112350221" target="_blank" rel="noopener noreferrer">commitlint 规范<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://github.com/WenHaoHuang/changelog-sn" target="_blank" rel="noopener noreferrer">实例<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://zhuanlan.zhihu.com/p/69635847" target="_blank" rel="noopener noreferrer">如何配置 Git Commit Message<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 安装</span>
yarn add @commitlint<span class="token operator">/</span>config<span class="token operator">-</span>conventional @commitlint<span class="token operator">/</span>cli <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// package.json中</span>
<span class="token string">&quot;commitlint&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;@commitlint/config-conventional&quot;</span> <span class="token comment">// 【校验规则】符合 Angular团队规范</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token comment">// 在 .commitlintrc.js 中</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'@commitlint/config-conventional'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置收敛至自定义的包中写法：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;commitlint&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>&quot;<span class="token punctuation">.</span><span class="token operator">/</span>node_modules<span class="token operator">/</span>@xxx<span class="token operator">/</span>xxx<span class="token operator">/</span>dist<span class="token operator">/</span>commitlint<span class="token punctuation">.</span>js”<span class="token punctuation">]</span> <span class="token comment">// 必须是数组</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h3 id="_5-cz"><a href="#_5-cz" class="header-anchor">#</a> 5.cz</h3> <p>可以用 <em>scripts</em> 命令进行提交信息校验</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token string">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;git-cz&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>配置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 安装</span>
yarn add commitizen <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// 常规适配器</span>
yarn add cz<span class="token operator">-</span>conventional<span class="token operator">-</span>changelog <span class="token operator">-</span><span class="token constant">D</span>

<span class="token comment">// package.json</span>
<span class="token string">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/cz-conventional-changelog&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 定制适配器</span>
yarn add cz<span class="token operator">-</span>customizable <span class="token operator">-</span><span class="token constant">D</span>

<span class="token string">&quot;config&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token string">&quot;commitizen&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/cz-customizable&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;cz-customizable&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;config&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./node_modules/@xxx/xxx/dist/czConfig.js&quot;</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/vue/vue源码/双向绑定.html">
        vue 源码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.a280ad29.js" defer></script><script src="/assets/js/2.fb79666b.js" defer></script><script src="/assets/js/40.04ca984c.js" defer></script>
  </body>
</html>
